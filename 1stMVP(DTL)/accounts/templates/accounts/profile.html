{% extends "base.html" %}
{% load static %}
{% block title %}내 프로필{% endblock %}
{% block nav_profile %}active{% endblock %}
{% block content %}
<section class="panel form-panel" style="max-width:720px;margin:auto;">
  <h1 class="form-title">내 프로필</h1>

  <div style="display:flex; gap:24px; align-items:flex-start; flex-wrap:wrap;">
     <!-- 아바타 -->
    <div style="flex:0 0 140px; text-align:center;">
      <div style="width:140px; height:140px; border-radius:50%; overflow:hidden; border:1px solid #eee; background:#fafafa;">
        {% if user.profile_image %}
          <img src="{{ user.profile_image.url }}" alt="avatar" style="width:100%; height:100%; object-fit:cover;">
        {% else %}
          <img src="{% static 'img/avatar_default.png' %}" alt="avatar" style="width:100%; height:100%; object-fit:cover;">
        {% endif %}
      </div>
      <div class="hint" style="margin-top:8px;">{{ user.username }}</div>
    </div>

    <!-- 정보 -->
    <div style="flex:1 1 360px;">
      <div class="field">
        <div class="label">아이디</div>
        <div class="hint">{{ user.username }}</div>
      </div>
      <div class="field">
        <div class="label">이름</div>
        <div class="hint">{{ user.last_name }} {{ user.first_name|default:"-" }}</div>
      </div>
      <div class="field">
        <div class="label">닉네임</div>
        <div class="hint">{{ user.nickname|default:"-" }}</div>
      </div>

      <div class="field">
        <div class="label">생년월일</div>
        <div class="hint">
          {% if user.birthdate %}
            {{ user.birthdate|date:"Y-m-d" }}
          {% else %}
            -
          {% endif %}
        </div>
      </div>

      <div class="field">
        <div class="label">휴대폰 번호</div>
        <div class="hint">{{ user.phone_number|default:"-" }}</div>
      </div>

      <div class="field">
        <div class="label">이메일</div>
        <div class="hint">{{ user.email|default:"-" }}</div>
      </div>


      <div class="field" style="display:flex; gap:16px;">
        <div style="flex:1">
          <div class="label">가입일</div>
          <div class="hint">{{ user.date_joined|date:"Y-m-d H:i" }}</div>
        </div>
        <div style="flex:1">
          <div class="label">마지막 로그인</div>
          <div class="hint">{{ user.last_login|date:"Y-m-d H:i"|default:"-" }}</div>
        </div>
      </div>

      <!-- 필요 시 통계 전달받으면 표시 (posts_count, comments_count를 view에서 context로 넘기면 자동 표시) -->
      {% if posts_count or comments_count %}
      <div class="field" style="display:flex; gap:16px;">
        {% if posts_count %}
        <div style="flex:1">
          <div class="label">작성 글</div>
          <div class="hint">{{ posts_count }}개</div>
        </div>
        {% endif %}
        {% if comments_count %}
        <div style="flex:1">
          <div class="label">작성 댓글</div>
          <div class="hint">{{ comments_count }}개</div>
        </div>
        {% endif %}
      </div>
      {% endif %}
    </div>
  </div>

  <div class="row" style="justify-content:flex-end; gap:8px; margin-top:16px;">
    <a href="{% url 'accounts:update_profile' %}" class="btn">프로필 수정</a>
    <a href="{% url 'accounts:change_password' %}" class="btn primary">비밀번호 변경</a>
  </div>
</section>
{% endblock %}
