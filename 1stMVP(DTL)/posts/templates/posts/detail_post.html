{% extends "base.html" %}
{% block title %}{{ post.title }}{% endblock %}
{% block nav_free %}active{% endblock %}

{% block content %}


<!-- ğŸ”¹ ê²Œì‹œê¸€ ì˜ì—­ -->
<section class="panel post-main">
  <header class="post-header" style="display:flex; align-items:flex-start; justify-content:space-between; gap:12px;">
    <div>
      <h1 style="margin:0; font-size:28px; font-weight:700;">
        [#{{ post.id }}] {{ post.title }}
      </h1>
      <div class="post-meta" style="margin-top:4px; font-size:13px; opacity:.85;">
        ì‘ì„±ì: {{ post.author }} Â· {{ post.created_at|date:"Y-m-d H:i" }}
        {% if post.updated_at and post.updated_at != post.created_at %}
          Â· ìˆ˜ì •: {{ post.updated_at|date:"Y-m-d H:i" }}
        {% endif %}
      </div>
    </div>

    <div class="post-actions" style="display:flex; gap:8px; flex-wrap:wrap;">
      <a class="btn small" href="{% url 'posts:index' %}">ëª©ë¡</a>
      {% if user.is_authenticated %}
        {% if user.is_superuser or user.pk == post.author_id %}
          <a href="{% url 'posts:update_post' post.id %}" class="btn small">ìˆ˜ì •</a>
          <form action="{% url 'posts:delete_post' post.id %}" method="post" class="inline-form" style="display:inline;">
            {% csrf_token %}
            <button type="submit" class="btn small" onclick="return confirm('ì •ë§ ì‚­ì œí• ê¹Œìš”?');">ì‚­ì œ</button>
          </form>
        {% endif %}
      {% endif %}
    </div>
  </header>

  <hr class="divider" />

  <div class="post-content">
    {{ post.content|linebreaksbr }}
  </div>
</section>


<!-- ğŸ”¹ ëŒ“ê¸€ ì˜ì—­ -->
<section class="panel comments-panel">
  <h3 style="margin-top:0;">ëŒ“ê¸€</h3>

  {% if comments %}
    <ul class="comment-list">
      {% for c in comments %}
        <li class="comment-item">
          <div>{{ c.content|linebreaksbr }}</div>
          <div class="comment-footer">
            <div class="comment-meta">
              {{ c.author }}ë‹˜ì˜ ëŒ“ê¸€ Â· {{ c.created_at|date:"Y-m-d H:i" }}
            </div>
            {% if user == c.author or usdr.is_superuser %}
              <div class="comment-actions">
                <a href="{% url 'posts:update_comment' post.id c.id %}" class="btn small">ìˆ˜ì •</a>
                <a href="{% url 'posts:delete_comment' post.id c.id %}" class="btn small danger">ì‚­ì œ</a>
              </div>
            {% endif %}
          </div>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <div class="hint">ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</div>
  {% endif %}

  <div style="margin-top:12px;">
    <a href="{% url 'posts:create_comment' post.id %}" class="btn primary">ëŒ“ê¸€ ì‘ì„±</a>
  </div>
</section>
{% endblock %}
